angular.module("froala",[]).value("froalaConfig",{}).directive("froala",["froalaConfig",function(c){var h=0;var a={immediateAngularModelUpdate:false,angularIgnoreAttrs:null};var e="innerHTML";var g={froalaOptions:"=froala",initFunction:"&froalaInit"};c=c||{};var d="manual";var f="automatic";var b=["img","button","input","a"];return{restrict:"A",require:"ngModel",scope:g,link:function(n,l,k,p){var j=false;if(b.indexOf(l.prop("tagName").toLowerCase())!=-1){j=true}var o={editorInitialized:false};n.initMode=k.froalaInit?d:f;o.init=function(){if(!k.id){k.$set("id","froala-"+h++)}if(n.initMode===f){o.createEditor()}p.$render=function(){if(o.editorInitialized){if(j){var r=p.$modelValue;if(r){for(var q in r){if(r.hasOwnProperty(q)&&q!=e){l.attr(q,r[q])}}if(r.hasOwnProperty(e)){l[0].innerHTML=r[e]}}}else{l.froalaEditor("html.set",p.$viewValue||"",true);l.froalaEditor("undo.reset");l.froalaEditor("undo.saveStep")}}};p.$isEmpty=function(q){if(!q){return true}var r=l.froalaEditor("node.isEmpty",jQuery("<div>"+q+"</div>").get(0));return r}};o.createEditor=function(r){o.listeningEvents=["froalaEditor"];if(!o.editorInitialized){r=(r||{});o.options=angular.extend({},a,c,n.froalaOptions,r);if(o.options.immediateAngularModelUpdate){o.listeningEvents.push("keyup")}var s=function(){o.editorInitialized=true;p.$render()};if(j){s()}else{o.registerEventsWithCallbacks("froalaEditor.initialized",function(){s()})}for(var q in o.options.events){if(o.options.events.hasOwnProperty(q)){o.registerEventsWithCallbacks(q,o.options.events[q])}}o.froalaElement=l.froalaEditor(o.options).data("froala.editor").$el;o.froalaEditor=angular.bind(l,l.froalaEditor);o.initListeners();if(n.froalaOptions){n.froalaOptions.froalaEditor=o.froalaEditor}}};o.initListeners=function(){if(o.options.immediateAngularModelUpdate){o.froalaElement.on("keyup",function(){n.$evalAsync(o.updateModelView)})}l.on("froalaEditor.contentChanged",function(){n.$evalAsync(o.updateModelView)});l.bind("$destroy",function(){l.off(o.listeningEvents.join(" "));l.froalaEditor("destroy");l=null})};o.updateModelView=function(){var r=null;if(j){var q=l[0].attributes;var s={};for(var u=0;u<q.length;u++){var t=q[u].name;if(o.options.angularIgnoreAttrs&&o.options.angularIgnoreAttrs.indexOf(t)!=-1){continue}s[t]=q[u].value}if(l[0].innerHTML){s[e]=l[0].innerHTML}r=s}else{var v=l.froalaEditor("html.get");if(angular.isString(v)){r=v}}p.$setViewValue(r);if(!n.$root.$$phase){n.$apply()}};o.registerEventsWithCallbacks=function(q,r){if(q&&r){o.listeningEvents.push(q);l.on(q,r)}};if(n.initMode===d){var m=o;var i={initialize:o.createEditor,destroy:function(){if(m.froalaEditor){m.froalaEditor("destroy");m.editorInitialized=false}},getEditor:function(){return m.froalaEditor?m.froalaEditor:null}};n.initFunction({initControls:i})}o.init()}}}]).directive("froalaView",["$sce",function(a){return{restrict:"ACM",scope:false,link:function(d,c,b){c.addClass("fr-view");d.$watch(b.froalaView,function(f){if(f||f===""){var e=a.trustAsHtml(f);c.html(e.toString())}})}}}]);